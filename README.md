# Тестовое задание на позицию CV Engineer в MynaLabs.ai
## ПОСТАНОВКА ЗАДАЧИ:
Необходимо написать классификатор картинок открытых ![002908](https://user-images.githubusercontent.com/85522162/132287106-bddd81c5-4771-42df-8a94-fc2e574b4cd8.jpg) (`class=1`) / закрытых ![002868](https://user-images.githubusercontent.com/85522162/132287071-0cea1a83-86ea-4178-a0e1-262a9282e895.jpg)
 (`class=0`) глаз, используя известную обучающую выборку. Решение будет проверяться на отложенной тестовой выборке (из того же распределения).

Особенности задачи — выборка не содержит меток классов открытых или закрытых глаз. Полная либо частичная разметка выборки, unsupervised кластеризация и т.д. - все это является частью задачи.


Решение должно быть реализовано на Python. Можно использовать любые библиотеки, но желательно не добавлять тяжеловесные зависимости без необходимости.
Запуск модели будет производится на ОС Linux или macOS. Скрипт запуска модели на вход принимает первым параметром путь до папки с картинками, а результат сохраняет в файл `result.csv` в следующем формате: `путь-до-файла,метка-класса`


![image](https://user-images.githubusercontent.com/85522162/132286520-f1ea340d-46bc-4112-afb1-702ed4d5c49f.png)

## РЕШЕНИЕ:
**1. МОДЕЛЬ**

Для решения поставленной задачи был выбран метод transfer learning. Используемый DL - фреймворк - PyTorch.
Была взята предобученная свёрточная часть от сети ResNet18 c "замороженными" слоями (кроме `BatchNorm`),
и для неё был обучен новый полносвязный классификатор с прореживанием (p=0,5) на входе.

**2. ДАННЫЕ**

Данные были полностью размечены вручную. Изображения были скопированы в соответствующие 
папки по категориям для использования класса`torch.datasets.ImageFolder()`.

**3. ОБУЧЕНИЕ**

Выборка была разбита на тренировочную и валидационную в соотношении 80/20. Процесс обучения занял 
25 эпох. Достигнутая точность классификации составила около 95%. Обученная модель была сохранена
в формате pickle в обычной и `state_dict` версиях.

**4. СКРИПТ ЗАПУСКА**

Для практического использования модели, в соответствии с заданием, был написан скрипт запуска `inference.py`.
Скрипт запускается из консоли с указанием пути к папке с изображениями
(пример: `python inference.py /home/username/code/edu/eyes/test/`). В процессе своей работы скрипт 
последовательно загружает из выбранной папки все изображения и подаёт их на вход модели.
Полученные результаты записываются в массив. По окончании работы скрипт сохраняет массив с 
результатами как CSV таблицу.
